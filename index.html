<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>JE Drycleaning — Order Online</title>
  <meta name="description" content="Order dry cleaning, laundry and bulk packages online from Jeth Enterprise Drycleaning (JE Drycleaning). Paystack or Pay on Delivery."/>
  <!-- TailwindCSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- React / ReactDOM / Babel (for running JSX directly) -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body class="bg-zinc-50 text-zinc-800">
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useMemo } = React;

    // ---------------------------------
    // Brand & Integrations
    // ---------------------------------
    const BRAND = {
      name: "Jeth Enterprise Drycleaning",
      short: "JE Drycleaning",
      green: "#118C4F",
    };

    // ---- Integrations config (FILL THESE IN) ----
    const INTEGRATIONS = {
      // Google Sheets Web App URL (Apps Script) — Deploy > Web app (must end with /exec)
      sheetUrl: "https://script.google.com/macros/s/REPLACE_WITH_YOUR_DEPLOYMENT_ID/exec",
      // EmailJS (optional) — create account at emailjs.com and fill these to receive order emails
      emailjs: {
        publicKey: "REPLACE_EMAILJS_PUBLIC_KEY",
        serviceId: "REPLACE_EMAILJS_SERVICE_ID",
        templateId: "REPLACE_EMAILJS_TEMPLATE_ID",
        toEmail: "owner@example.com",
      },
    };

    const PAYMENT = {
      paystackPublicKey: "pk_test_xxxxx", // replace with your real public key
    };

    const CURRENCY = (n) => `₦${(n ?? 0).toLocaleString("en-NG")}`;

    // --- script loaders ---
    let __paystackScriptLoading, __emailjsScriptLoading;
    function ensurePaystackScript() {
      if (typeof window !== 'undefined' && window.PaystackPop) return Promise.resolve();
      if (__paystackScriptLoading) return __paystackScriptLoading;
      __paystackScriptLoading = new Promise((resolve, reject) => {
        const s = document.createElement('script');
        s.src = 'https://js.paystack.co/v1/inline.js';
        s.async = true;
        s.onload = () => resolve();
        s.onerror = () => reject(new Error('Failed to load Paystack'));
        document.body.appendChild(s);
      });
      return __paystackScriptLoading;
    }
    function ensureEmailJSScript() {
      if (typeof window !== 'undefined' && window.emailjs) return Promise.resolve();
      if (__emailjsScriptLoading) return __emailjsScriptLoading;
      __emailjsScriptLoading = new Promise((resolve, reject) => {
        const s = document.createElement('script');
        s.src = 'https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js';
        s.async = true;
        s.onload = () => resolve();
        s.onerror = () => reject(new Error('Failed to load EmailJS'));
        document.body.appendChild(s);
      });
      return __emailjsScriptLoading;
    }

    // ---------------------------------
    // Catalog (midpoint pricing of ranges)
    // ---------------------------------
    const CATEGORIES = [
      {
        key: "garments",
        title: "Garment Dry Cleaning (Per Item)",
        items: [
          { id: "shirt", name: "Shirt", price: 750, note: "Range ₦600–₦900" },
          { id: "tshirt", name: "T-shirt", price: 550, note: "Range ₦500–₦600" },
          { id: "trouser", name: "Trouser / Pants", price: 950, note: "Range ₦800–₦1,125" },
          { id: "blazer", name: "Jacket / Blazer", price: 1350, note: "Range ₦1,200–₦1,500" },
          { id: "suit2", name: "2-Piece Suit", price: 2000, note: "Range ₦1,800–₦2,250" },
          { id: "suit3", name: "3-Piece Suit", price: 2600, note: "Range ₦2,550–₦2,625" },
          { id: "trad_buba", name: "Traditional (Buba & Sokoto)", price: 2100, note: "Range ₦1,500–₦2,650" },
          { id: "agbada", name: "Agbada (Complete)", price: 3300, note: "Range ₦2,625–₦4,000" },
          { id: "wedding", name: "Wedding Gown", price: 12250, note: "Range ₦7,500–₦17,000" },
        ],
      },
      {
        key: "specialty",
        title: "Specialty Garments & Traditional Wear",
        items: [
          { id: "evening", name: "Evening / Cocktail Dress", price: 2350, note: "Range ₦2,150–₦2,550" },
          { id: "native_agbada", name: "Native Complete Agbada", price: 3300, note: "Range ₦2,625–₦4,000" },
          { id: "aso_oke", name: "Aso Oke (Complete)", price: 4500, note: "Range ₦4,000–₦5,000" },
        ],
      },
      {
        key: "household",
        title: "Laundry & Household Items",
        items: [
          { id: "bedsheet_single", name: "Bedsheet (single)", price: 1050, note: "Range ₦900–₦1,200" },
          { id: "bedsheet_double", name: "Bedsheet (double)", price: 1600, note: "Range ₦1,125–₦2,000" },
          { id: "duvet", name: "Duvet", price: 2625, note: "Range ₦2,250–₦3,000" },
          { id: "duvet_cover", name: "Duvet Cover", price: 1425, note: "Range ₦1,350–₦1,500" },
          { id: "blanket", name: "Blanket", price: 2450, note: "Range ₦1,875–₦3,000" },
          { id: "towel", name: "Towel", price: 1125, note: "Range ₦750–₦1,500" },
          { id: "bathrobe", name: "Bathrobe", price: 1350, note: "~₦1,350" },
          { id: "curtains_sqy", name: "Curtains (per sq yard)", price: 550, unit: "sq yd", note: "Range ₦500–₦600 (enter sq yds)" },
        ],
      },
    ];

    const BULK = [
      { id: "bulk15F", name: "Bulk Garment (15 pcs) – Ladies", price: 11000, note: "Avg ₦733/item" },
      { id: "bulk15M", name: "Bulk Garment (15 pcs) – Gentlemen", price: 10800, note: "Avg ₦720/item" },
      { id: "wash56", name: "Wash & Iron Subscription – 56 pcs (Pro’clean Confam)", price: 12500, note: "~₦223/item" },
      { id: "wash110", name: "Wash & Iron Subscription – 110 pcs (Pro’clean Buga)", price: 25550, note: "~₦232/item" },
    ];

    // ---------------------------------
    // UI Helpers
    // ---------------------------------
    const Section = ({ title, children, right }) => (
      <section className="bg-white border border-zinc-200 rounded-2xl shadow-sm p-5 md:p-6">
        <div className="flex items-center justify-between mb-4">
          <h2 className="text-lg md:text-xl font-semibold text-zinc-800">{title}</h2>
          {right}
        </div>
        {children}
      </section>
    );

    const Qty = ({ value, onChange, min = 0 }) => (
      <div className="inline-flex items-center rounded-xl border border-zinc-300 overflow-hidden">
        <button className="px-3 py-1.5 hover:bg-zinc-50" onClick={() => onChange(Math.max(min, (value || 0) - 1))}>−</button>
        <input className="w-14 text-center py-1.5 outline-none" type="number" min={min} value={value || 0} onChange={(e) => onChange(Math.max(min, Number(e.target.value)))} />
        <button className="px-3 py-1.5 hover:bg-zinc-50" onClick={() => onChange((value || 0) + 1)}>＋</button>
      </div>
    );

    function useCart() {
      const [cart, setCart] = useState({});
      const setQty = (item, qty) => {
        setCart((c) => {
          const copy = { ...c };
          if (qty <= 0) delete copy[item.id];
          else copy[item.id] = { name: item.name, price: item.price, unit: item.unit, qty };
          return copy;
        });
      };
      return { cart, setQty, setCart };
    }

    const JEHeader = () => (
      <header className="sticky top-0 z-40 backdrop-blur bg-white/70 border-b border-zinc-200">
        <div className="max-w-6xl mx-auto px-4 py-3 flex items-center justify-between">
          <div className="flex items-center gap-3">
            <svg width="34" height="34" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M10 20c0-3.3 2.7-6 6-6h32" stroke={BRAND.green} strokeWidth="4" strokeLinecap="round"/>
              <path d="M20 14v24c0 7.7 6.3 14 14 14h10" stroke={BRAND.green} strokeWidth="4" strokeLinecap="round"/>
              <rect x="36" y="30" width="18" height="18" rx="3" stroke={BRAND.green} strokeWidth="4"/>
              <circle cx="45" cy="39" r="5" stroke={BRAND.green} strokeWidth="4"/>
            </svg>
            <div className="leading-tight">
              <div className="text-xl font-bold" style={{ color: BRAND.green }}>JE Drycleaning</div>
              <div className="text-xs text-zinc-500">Fresh. Fast. Professional.</div>
            </div>
          </div>
          <a href="#order" className="hidden md:inline-flex items-center gap-2 px-4 py-2 rounded-xl text-white" style={{ backgroundColor: BRAND.green }}>Place Order</a>
        </div>
      </header>
    );

    // ---------------------------------
    // App
    // ---------------------------------
    function App() {
      const { cart, setQty, setCart } = useCart();
      const [bulk, setBulk] = useState({});
      const [form, setForm] = useState({ name: "", phone: "", email: "", address: "", date: "", time: "" });

      const { itemsSubtotal, bulkSubtotal, goodsTotal } = useMemo(() => {
        const itemsSubtotal = Object.values(cart).reduce((s, it) => s + it.price * (it.qty || 0), 0);
        const bulkSubtotal = Object.entries(bulk).reduce((s, [id, qty]) => {
          const pkg = BULK.find((p) => p.id === id);
          return s + (pkg ? pkg.price * qty : 0);
        }, 0);
        return { itemsSubtotal, bulkSubtotal, goodsTotal: itemsSubtotal + bulkSubtotal };
      }, [cart, bulk]);

      const grandTotal = goodsTotal;

      const resetAll = () => {
        setCart({});
        setBulk({});
        setForm({ name: "", phone: "", email: "", address: "", date: "", time: "" });
      };

      const handlePlaceOrder = async () => {
        const payload = {
          brand: BRAND.name,
          order: { cart, bulk, totals: { itemsSubtotal, bulkSubtotal, goodsTotal, grandTotal } },
          customer: form,
          createdAt: new Date().toISOString(),
        };

        // 1) Google Sheet (optional, if configured)
        try {
          if (INTEGRATIONS.sheetUrl && INTEGRATIONS.sheetUrl.includes('/exec')) {
            await fetch(INTEGRATIONS.sheetUrl, {
              method: 'POST',
              mode: 'no-cors',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify(payload),
            });
          }
        } catch (e) {
          console.warn('Sheet submit failed:', e);
        }

        // 2) Email (optional, if configured)
        try {
          if (INTEGRATIONS.emailjs.publicKey && INTEGRATIONS.emailjs.publicKey !== 'REPLACE_EMAILJS_PUBLIC_KEY') {
            await ensureEmailJSScript();
            window.emailjs.init(INTEGRATIONS.emailjs.publicKey);
            await window.emailjs.send(
              INTEGRATIONS.emailjs.serviceId,
              INTEGRATIONS.emailjs.templateId,
              {
                to_email: INTEGRATIONS.emailjs.toEmail,
                customer_name: form.name,
                customer_phone: form.phone,
                customer_email: form.email,
                order_total: CURRENCY(grandTotal),
                order_json: JSON.stringify(payload, null, 2),
              }
            );
          }
        } catch (e) {
          console.warn('EmailJS send failed:', e);
        }

        alert(\`Order placed!\n\nTotal: \${CURRENCY(grandTotal)}\nWe'll contact you shortly.\`);
        console.log("JE ORDER", payload);
        resetAll();
      };

      const handlePaystack = async () => {
        if (!form.name || !form.phone || !form.email) return alert("Please enter your name, phone, and email.");
        if (grandTotal <= 0) return alert("Your cart is empty.");
        try {
          await ensurePaystackScript();
          const amountKobo = Math.round(grandTotal * 100);
          const handler = window.PaystackPop.setup({
            key: PAYMENT.paystackPublicKey,
            email: form.email,
            amount: amountKobo,
            currency: 'NGN',
            metadata: {
              custom_fields: [
                { display_name: 'Customer', variable_name: 'customer_name', value: form.name },
                { display_name: 'Phone', variable_name: 'phone', value: form.phone }
              ]
            },
            callback: async function(response) {
              alert('Payment complete! Ref: ' + response.reference);
              await handlePlaceOrder();
            },
            onClose: function() {
              console.log('Paystack modal closed');
            }
          });
          handler.openIframe();
        } catch (e) {
          alert('Could not start Paystack: ' + e.message);
        }
      };

      return (
        <div className="min-h-screen bg-zinc-50 text-zinc-800">
          <JEHeader />

          {/* Hero */}
          <section className="relative">
            <div className="max-w-6xl mx-auto px-4 py-12 md:py-16 grid md:grid-cols-2 gap-8 items-center">
              <div>
                <h1 className="text-3xl md:text-5xl font-extrabold leading-tight mb-4" style={{ color: BRAND.green }}>
                  Clean clothes, on your schedule.
                </h1>
                <p className="text-zinc-600 text-lg md:text-xl mb-6">
                  Order dry cleaning, laundry, and more in minutes. Transparent pricing and professional finishing.
                </p>
                <a href="#order" className="inline-flex items-center gap-2 px-5 py-3 rounded-2xl text-white font-semibold" style={{ backgroundColor: BRAND.green }}>
                  Start an Order
                </a>
              </div>
            </div>
          </section>

          {/* Main */}
          <main id="order" className="max-w-6xl mx-auto px-4 pb-20 grid lg:grid-cols-3 gap-6">
            <div className="lg:col-span-2 space-y-6">
              {CATEGORIES.map((cat) => (
                <Section key={cat.key} title={cat.title}>
                  <div className="divide-y">
                    {cat.items.map((it) => (
                      <div key={it.id} className="py-3 flex items-center gap-4">
                        <div className="flex-1">
                          <div className="font-medium">{it.name} {it.unit && <span className="text-xs text-zinc-500">({it.unit})</span>}</div>
                          <div className="text-sm text-zinc-500">{it.note}</div>
                        </div>
                        <div className="w-24 text-right font-semibold">{CURRENCY(it.price)}</div>
                        <Qty value={cart[it.id]?.qty || 0} onChange={(q)=>setQty(it, q)} />
                      </div>
                    ))}
                  </div>
                </Section>
              ))}

              <Section title="Bulk Packages & Subscriptions">
                <div className="divide-y">
                  {BULK.map((pkg)=> (
                    <div key={pkg.id} className="py-3 flex items-center gap-4">
                      <div className="flex-1">
                        <div className="font-medium">{pkg.name}</div>
                        <div className="text-sm text-zinc-500">{pkg.note}</div>
                      </div>
                      <div className="w-28 text-right font-semibold">{CURRENCY(pkg.price)}</div>
                      <Qty value={bulk[pkg.id]||0} onChange={(q)=>setBulk((b)=> ({...b, [pkg.id]: q}))} />
                    </div>
                  ))}
                </div>
              </Section>

              <Section title="Contact Details">
                <div className="grid md:grid-cols-2 gap-4">
                  <div>
                    <label className="text-sm text-zinc-600">Full Name</label>
                    <input className="w-full rounded-xl border border-zinc-300 px-3 py-2" value={form.name} onChange={e=>setForm({...form, name: e.target.value})}/>
                  </div>
                  <div>
                    <label className="text-sm text-zinc-600">Phone</label>
                    <input className="w-full rounded-xl border border-zinc-300 px-3 py-2" value={form.phone} onChange={e=>setForm({...form, phone: e.target.value})}/>
                  </div>
                  <div>
                    <label className="text-sm text-zinc-600">Email</label>
                    <input type="email" className="w-full rounded-xl border border-zinc-300 px-3 py-2" value={form.email} onChange={e=>setForm({...form, email: e.target.value})}/>
                  </div>
                  <div className="md:col-span-2">
                    <label className="text-sm text-zinc-600">Address</label>
                    <input className="w-full rounded-xl border border-zinc-300 px-3 py-2" value={form.address} onChange={e=>setForm({...form, address: e.target.value})}/>
                  </div>
                  <div>
                    <label className="text-sm text-zinc-600">Preferred Date</label>
                    <input type="date" className="w-full rounded-xl border border-zinc-300 px-3 py-2" value={form.date} onChange={e=>setForm({...form, date: e.target.value})}/>
                  </div>
                  <div>
                    <label className="text-sm text-zinc-600">Preferred Time</label>
                    <input type="time" className="w-full rounded-xl border border-zinc-300 px-3 py-2" value={form.time} onChange={e=>setForm({...form, time: e.target.value})}/>
                  </div>
                </div>
              </Section>
            </div>

            <div className="lg:col-span-1 space-y-6">
              <Section title="Order Summary" right={<span className="text-xs text-zinc-500">All prices VAT-inclusive</span>}>
                <div className="space-y-2 text-sm">
                  <Row label="Per-item subtotal" value={itemsSubtotal} />
                  <Row label="Bulk & subscriptions" value={bulkSubtotal} />
                  <hr className="my-2"/>
                  <Row label="Total to pay" value={grandTotal} strong />
                  <div className="space-y-2">
                    <button onClick={handlePaystack} className="w-full py-3 rounded-2xl text-white font-semibold disabled:opacity-50" style={{ backgroundColor: BRAND.green }} disabled={!form.name || !form.phone || !form.email}>
                      Pay with Paystack
                    </button>
                    <div className="text-xs text-zinc-500">Or choose manual payment:</div>
                    <button onClick={handlePlaceOrder} className="w-full py-3 rounded-2xl text-white font-semibold disabled:opacity-50" style={{ backgroundColor: BRAND.green }} >
                      Place Order (Pay on Delivery/Transfer)
                    </button>
                  </div>
                </div>
              </Section>
            </div>
          </main>

          <footer className="border-t border-zinc-200 mt-10">
            <div className="max-w-6xl mx-auto px-4 py-8 text-sm flex flex-col md:flex-row gap-3 items-center justify-between">
              <div className="text-zinc-500">© {new Date().getFullYear()} {BRAND.name}. All rights reserved.</div>
              <div className="flex items-center gap-3 text-zinc-500">
                <a className="hover:text-zinc-700" href="#">Terms</a>
                <span>•</span>
                <a className="hover:text-zinc-700" href="#">Privacy</a>
                <span>•</span>
                <a className="hover:text-zinc-700" href="#">Contact</a>
              </div>
            </div>
          </footer>
        </div>
      );
    }

    function Row({ label, value, strong }) {
      return (
        <div className="flex items-center justify-between">
          <span className={strong ? "font-semibold" : ""}>{label}</span>
          <span className={strong ? "font-semibold" : ""}>{CURRENCY(value || 0)}</span>
        </div>
      );
    }

    // ---------------------------------
    // Minimal runtime tests (dev assertions)
    // ---------------------------------
    (function runDevTests(){
      try {
        const testCart = { a: { price: 750, qty: 2 }, b: { price: 1350, qty: 1 } }; // 750*2 + 1350 = 2850
        const itemsSubtotal = Object.values(testCart).reduce((s, it) => s + it.price * (it.qty || 0), 0);
        console.assert(itemsSubtotal === 2850, \`itemsSubtotal expected 2850, got \${itemsSubtotal}\`);

        const pkgPrice = 12500; // wash56
        const bulkSubtotal = pkgPrice * 1;
        console.assert(bulkSubtotal === 12500, \`bulkSubtotal expected 12500, got \${bulkSubtotal}\`);

        const goodsTotal = itemsSubtotal + bulkSubtotal; // 2850 + 12500 = 15350
        console.assert(goodsTotal === 15350, \`goodsTotal expected 15350, got \${goodsTotal}\`);

        const grandTotal = goodsTotal;
        console.assert(grandTotal === 15350, \`grandTotal expected 15350, got \${grandTotal}\`);

        if (typeof window !== 'undefined') window.__JE_TESTS_OK__ = true;
      } catch (e) {
        console.error("JE dev tests failed", e);
      }
    })();

    // Mount app
    const root = ReactDOM.createRoot(document.getElementById("root"));
    root.render(<App />);
  </script>
</body>
</html>
